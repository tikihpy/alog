# 自动化测试初步规划

# 背景

软件测试分层：



![](http://ww2.sinaimg.cn/large/006tNc79ly1g62j8l4wg4j30h206u0ul.jpg "img")

1）表现层（UI）：用户界面，即用户可见的操作界面或者入口。

2）业务逻辑层（BLL）：封装具有业务含义的操作函数。

3）数据处理层（DAL）：封装对数据库或者其他存储介质的原子性操作。



* **单元测试**关注代码的实现逻辑，例如一个if 分支或一个for循环的实现，一般都有研发负责测试。

* **集成、接口测试**关注的一是个函数、类（方法）所提供的接口是否可靠。

* **UI测试**就是最简单的在页面上面的点点点测试，也是最简单的黑盒手工测试！UI自动化必须自己写脚本，一开始我们可以通过录制脚本熟悉被测产品UI自动化脚本是怎样写的。

* **金字塔形**，是为了表示不同阶段所投入自动化测试的比例：

  * 越下层投入应当越多

  * 越下层效率越高

  * 越下层成本越低

  * 越下层实现专业性要求越高

在《google 测试之道》一书，对于google产品，70%的投入为单元测试，20%为集成、接口测试，10% 为UI层的自动化测试。

因为越往上层，其维护成本越高。尤其是UI层的元素会时常的发生改变。所以，**我们应该把更多的自动化测试放在单元测试与接口测试阶段进行。**

如果一个产品从没有做单元测试与接口测试，只做UI层的自动化测试是不科学的，从而很难从本质上保证产品的质量。但如果妄图实现全面的UI层的自动化测试，那更是一个劳民伤财的举动，投入了大量人力时间，最终获得的收益可能会远远低于所支付的成本。

　　既然UI层的自动化测试这么劳民伤财，那我们只做单元测试与接口测试是否可行？**不管什么样的产品，最终呈现给用户的是UI层。**所以，测试人员应该把更多的精力放在UI层。那么也正是因为测试人员在UI层投入大量的精力，所以，有必要通过自动化的方式帮助我们“部分解放”重复的劳动。



# 目的



1、数据处理层、业务逻辑层，通过自动化的方式实现“全面解放”重复的工作；

2、UI界面层，通过自动化的方式实现“部分解放”重复的工作；

通过引入自动化测试工具和方案，提高测试执行效率降低人工回归的成本，缩短项目测试周期。



# 职责划分

* 单元测试研发负责；

* 集成测试、接口自动化测试、UI层自动化测试，前期研发协助测试进行，最终由测试部负责；



# 要求

### 自动化测试开展的软件项目要求：

* 软件需求变动不频繁

　　测试脚本的稳定性决定了自动化测试的维护成本。如果软件需求变动过于频繁，测试人员需要根据变动的需求来更新测试用例以及相关的测试脚本，而脚本的维护本身就是一个代码开发的过程，需要修改、调试，必要的时候还要修改自动化测试的框架，如果所花费的成本不低于利用其节省的测试成本，那么自动化测试便是失败的。

　　项目中的某些模块相对稳定，而某些模块需求变动性很大。我们便可对相对稳定的模块进行自动化测试，而变动较大的仍是用手工测试。

* 项目周期较长

由于自动化测试需求的确定、自动化测试框架的设计、测试脚本的编写与调试均需要相当长的时间来完成。这样的过程本身就是一个测试软件的开发过程，需要较长的时间来完成。如果项目的周期比较短，没有足够的时间去支持这样一个过程，那么自动化测试便成为笑谈。

* 自动化测试脚本可重复使用

　　自动化测试脚本的重复使用要从三个方面来考量，一方面所测试的项目之间是否很大的差异性（如C/S系统和B/S系统的差异）；所选择的测试工具是否适应这种差异；最后，测试人员是否有能力开发出适应这种差异的自动化测试框架。



### 自动化测试通过的标准：

* 单元测试研发负责，测试核对单元测试覆盖率，覆盖率&gt;90%以上通过；

* 自动化测试用例和数据集达到100%需求覆盖；

* 自动化测试用例100%被执行；

* 测试过程中缺陷率达到系统测试质量标准：DI&lt;20，无致命、严重bug，千行代码bug数1-2个。



# 现状

#### 目睹直播平台

* 开放API+平台所有API \[ PHP老代码API（这部分接口无接口文档）\]

* 开放API：[http://mudu.tv/api/v1/](http://mudu.tv/api/v1/)

* 平台功能多，需按模块提取核心功能流程来做UI自动化，逐步叠加；

* 控制台后续会重构，部分互动功能也需要重构，需重构部分暂时不适合做自动化；

* 文档覆盖50%左右的接口

#### 目睹布谷平台

* API档：

[http://bugu.mudu.tv/dev/%E9%9B%86%E6%88%90%E6%8E%A5%E5%85%A5/%E7%9B%B4%E6%92%AD%E5%A4%96%E5%B5%8C.html](http://bugu.mudu.tv/dev/%E9%9B%86%E6%88%90%E6%8E%A5%E5%85%A5/%E7%9B%B4%E6%92%AD%E5%A4%96%E5%B5%8C.html)

* 接口文档不全，补充后进入接口自动化

* 文档覆盖40%左右的接口

#### 目睹制播平台

* API文档地址：[http://119.3.93.35:8888/\#/](http://119.3.93.35:8888/#/)

* 账号：weilin 密码：asdfashkjhlkj

* 刚与目睹直播平台对接部分接口需补充，其他文档相对齐全；

* 文档覆盖80%左右的接口

#### 目睹有课平台

* 有课API文档postman平台，[hanyingwei@mudu.tv](mailto:hanyingwei@mudu.tv)密码 mudu.pub123!@\#

* 接口文档不全，需补充后进入接口自动化；

* 文档覆盖50%左右的接口



# 方案设想及规划

## 第一阶段：工具实现-业务逻辑层部分自动化

### 1、对象：

目睹制播平台

经技术管理组讨论，因制播平台的接口文档相对比较齐全，可以优先进入接口自动化测试。

### 2、目标：

完成全平台接口文档整理，实现核心功能接口自动化；

### 3、方式：

借助自动化接口测试工具Postman、jmeter进行接口调试及压力测试，通过自动化接口管理平台YAPI，将全平台接口进行整合管理，以实现核心接口自动化测试。

### 4、工具

YAPI平台介绍：

[http://mudu.ns.4l.hk:3000/project/10/interface/api](http://mudu.ns.4l.hk:3000/project/10/interface/api)

[crper@outlook.com](mailto:crper@outlook.com)123456

### 5、方法

1、完善接口文档，整理各产品线现有的API文档，并补全缺少部分的文档

2、提取核心功能模块API清单

3、完善核心接口测试用例，根据核心功能模块API清单，按模块设计测试用例，评审

4、核心接口测试用例脚本化，通过YAPI平台整合，实现功能自动化测试

5、使用jmeter实现接口性能测试

6、接口验收



### 6、测试人员分配

接口自动化测试人员：1-2人





## 第二阶段：工具实现-业务逻辑层全面自动化+UI层部分自动化

### 1、对象：

目睹直播、目睹布谷、目睹有课

### 2、目标：

完成所有全平台接口文档整理，实现全功能接口自动化，核心主流程功能UI自动化；

### 3、方式：

业务逻辑层：借助自动化接口测试工具Postman、jmeter进行接口调试及压力测试，通过自动化接口管理平台YAPI，将全平台接口进行整合管理，以实现核心接口自动化测试；

UI层：借助工具Cypress进行部分核心功能模块端到端自动化测试；

### 4、工具

Cypress工具介绍：

[https://github.com/tikihpy/alog/blob/master/e2ecypress.md](https://github.com/tikihpy/alog/blob/master/e2ecypress.md)

Cypressy运行效果：[http://mudu.ns.4l.hk/show/videolink/m76rb39l/origin](http://mudu.ns.4l.hk/show/videolink/m76rb39l/origin)

### 5、方法

1.1、接口部分：根据阶段1的逻辑持续完善；

1.2、UI部分：

1.2.1、功能测试用例的完善，提取核心功能

1.2.2、熟悉测试工具Cypress

2、UI部分：根据功能测试用例，通过测试工具进行核心功能模块流程全用例覆盖

3、接口验收



### 6、测试人员分配

接口自动化测试人员：2-3人





## 第三阶段：代码实现-业务逻辑层部分自动化

### 1、对象：

直播、布谷、制播、有课

### 2、目标：

完成所有全平台接口文档整理，实现核心功能接口自动化；

### 3、方式：

Python + unittest + requests 接口自动化测试框架

unittest:

[https://segmentfault.com/a/1190000016315201?utm\_source=tag-newest](https://segmentfault.com/a/1190000016315201?utm_source=tag-newest)

[https://docs.python.org/3/library/unittest.html](https://docs.python.org/3/library/unittest.html)

### 4、工具

* 编码IDE

* gitlab



### 5、方法

1、搭建测试环境，熟悉测试框架

2、根据核心功能模块测试用例，进行脚本编写，持续集成

3、脚本验收



### 6、测试人员分配

测试开发人员：3-4人





## 第四阶段：代码实现-业务逻辑层全面自动化+UI层部分自动化

### 1、对象：

直播、布谷、制播、有课

### 2、目标：

完成所有全平台接口文档整理，实现全功能接口自动化，核心主流程功能UI自动化；

### 3、方式：

业务逻辑层：Python + unittest + requests 接口自动化测试框架

UI层：要考虑到兼容性

web端 Python + selenium + unittest

移动端自动化 Python + Appium

Selenium介绍：

[https://www.seleniumhq.org/docs/cn/01\_introducing\_selenium.jsp](https://www.seleniumhq.org/docs/cn/01_introducing_selenium.jsp)

selenium简单运行效果：[http://mudu.ns.4l.hk/show/videolink/lj117rdl/origin](http://mudu.ns.4l.hk/show/videolink/lj117rdl/origin)

Appium介绍：

[https://github.com/tikihpy/alog/blob/master/appium.md](https://github.com/tikihpy/alog/blob/master/appium.md)

相关教程介绍：

[https://www.cnblogs.com/fnng/p/4540731.html](https://www.cnblogs.com/fnng/p/4540731.html)

### 4、工具

* 编码IDE

* Gitlab



### 5、方法

1.1、接口层面：根据阶段3的逻辑持续集成

1.2、UI层面：

1.2.1、web端搭建测试环境，熟悉测试框架

1.2.2、移动端搭建测试环境，熟悉测试框架

2、根据全功能模块测试用例，进行脚本编写，持续集成

3、脚本验收



### 6、测试人员分配

测试开发人员：3-4人

















